<style>
    /* 目录子级默认隐藏 - 原生CSS标准写法 无嵌套 无兼容问题 */
    #TableOfContents > ul ul,
    #TableOfContents > ul ol,
    #TableOfContents > ol ul,
    #TableOfContents > ol ol {
        display: none;
    }
    #TableOfContents .open {
        display: block !important;
    }
</style>

<script>
    function initTocHide() {
        // 判断是否存在文章目录，无则直接退出
        let toc = document.querySelector(".widget--toc");
        if (!toc) return;
        
        // 防抖函数 解决滚动高频触发卡顿
        let timer = null;
        window.addEventListener('scroll', function() {
            clearTimeout(timer);
            timer = setTimeout(() => {
                // 清除所有展开的open类
                document.querySelectorAll(".open").forEach(el => el.classList.remove("open"));
                
                // 获取当前激活的目录项
                const currentLi = document.querySelector(".active-class");
                if (!currentLi) return;

                // 展开当前项的子级ul/ol
                if (currentLi.children.length > 1) {
                    currentLi.children[1].classList.add("open");
                }

                // 向上遍历展开所有父级目录，绝对无空指针报错
                let parentUl = currentLi.parentElement;
                while (parentUl && (parentUl.tagName === 'UL' || parentUl.tagName === 'OL')) {
                    parentUl.classList.add("open");
                    const grandParent = parentUl.parentElement;
                    parentUl = grandParent ? grandParent.parentElement : null;
                }
            }, 80);
        });
    }
    // 初始化目录功能
    initTocHide();
</script>

<!-- ✅✅✅ 这里是唯一正确的位置！！！ Hugo模板语法 必须写在 所有HTML标签中，不能写在<script>里 -->
{{ partial "footer/code-block.html" . }}

{{ partial "footer/fish.html" . }}

{{/*  我选择放弃实现返回顶部功能
{{ partial "footer/return.html" . }}   */}}

{{ partial "footer/copy.html" . }}

{{ partial "footer/font.html" . }}